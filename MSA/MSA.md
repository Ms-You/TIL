# MSA #
## 모놀리식 아키텍처 ##
 하나의 시스템이 서비스 전체 기능을 처리하도록 설계한 아키텍처
#### 장점 ####
<b>1. 네트워크로 인한 지연이나 데이터 유실이 없음</b>
- MSA는 서비스 단위로 기능이 개발되므로 데이터가 MSA 사이에서 전송되며, 네트워크를 통해 전송되면서 지연이나 유실의 위험이 있음
- 모놀리식 아키테거는 클래스의 조합으로 이루어지며, 데이터는 객체들 사이에서만 전달됨

<b>2. 시스템 장애나 버그 발생 시 하나의 애플리케이션에서 원인 파악이 가능함</b>

<br />

#### 단점 ####
<b>1. 소스 코드와 복잡도가 증가함</b>

<b>2. 시스템 확장이 어려움</b>
- 주문과 결제 기능이 있는 애플리케이션에서 주문 기능의 요청이 훨씬 많은 경우, 서버를 Scale-out 해서 처리 능력을 선형적으로 늘리는 것은 비효율적임

<br />
<br />
<br />

## 마이크로 서비스 아키텍처 ##
<b style="color:skyblue">기능 위주로 나눠진 여러 애플리케이션이 있고, 각각 독립된 데이터 저장소를 사용함</b>
- 기능으로 분리된 애플리케이션들은 미리 정의된 API를 통해 서로 유기적으로 동작함
- 각 애플리케이션은 다양한 언어와 데이터베이스로 구성될 수 있음

<br />

<b style="color:skyblue">마이크로 서비스들은 다른 마이크로 서비스에 독립적으로 구성되어야 함</b>
- 서비스에 장애가 발생했을 때 다른 서비스에 영향을 끼치는 <span style="color:orange">단일 장애 지점</span>이 존재하면 안됨
- 따라서 마이크로 서비스마다 각각 독립된 데이터 저장소가 필요함
  - 데이터 저장소를 공유할 경우, 특정 마이크로 서비스가 데이터 저장소의 리소스를 모두 차지해서 다른 서비스가 데이터를 처리하지 못해 데이터 저장소가 단일 장애 지점이 될 수 있기 때문

<br />

<b style="color:skyblue">마이크로 서비스는 기능과 성격에 맞게 잘 분리되어야 함</b>
- 특정 마이크로 서비스에 기능을 집중하면 서비스 전체가 하나의 마이크로 서비스에 의존하게 됨
- 너무 세밀하게 분리하면 수많은 마이크로 서비스를 관리해야 함

<br />

<b style="color:skyblue">통신에 사용되는 네트워크 프로토콜은 가벼워야 함</b>
- 각 마이크로 서비스 컴포넌트는 API를 통해 통신하는데 API가 사용하는 네트워크 프로토콜이 성능 저하의 원인이 될 수 있음
  - 네트워크를 통해 전달되는 데이터 객체는 바이트 형태로 직렬화 되어야 하고, 받는 쪽에서는 바이트 데이터를 객체로 역직렬화 함
  - 직렬화 된 바이트의 크기가 너무 크면 네트워크 성능 저하가 발생하고, 직렬화/역직렬화 과정에서 CPU 같은 시스템 리소스를 많이 사용하면 전반적인 성능 저하가 발생함
- 보통 JSON 형식의 메시지를 주고 받으며, HTTP 기반의 REST API를 사용함
- 비동기 처리를 위해 AMQP 프로토콜을 사용하는 메시지 큐 시스템 기반으로 데이터를 주고받을 수 있음 (RabbitMQ, Kafka ...)
  - 메시지 큐 시스템 기반의 데이터 교환은 REST API보다 높은 신뢰성을 제공하지만, 메시지 큐에 의존하게 되어 단일 장애 지점이 될 수 있음

#### 장점 ####
<b>1. 독립성</b>
<br />
하나의 마이크로 서비스는 하나의 기능을 담당하므로 다른 마이크로 서비스와의 간섭이 최소화됨

<b>2. 대용량 데이터 처리가 비교적 자유로움</b>
<br />
마이크로 서비스는 독립된 데이터 저장소를 갖기 때문에 대용량 데이터를 마이크로 서비스마다 나누어 저장할 수 있음

<b>3. 장애에 견고함</b>
<br />

<b>4. 빠른 배포 주기</b>
<br />
모놀리식 아키텍처와 달리, 마이크로 서비스는 모든 기능이 분리되어 있으므로 필요한 기능만 먼저 배포할 수 있음

<b>5. 높은 확장성</b>
<br />
필요한 마이크로 서비스만 확장하면 되므로 효율적으로 시스템 자원을 활용할 수 있고 <span style="color:gray">(위에서의 주문과 결제 예시)</span>, 클라우드 시스템과 결합하면 동적 확장도 가능함

#### 단점 ####
<b>1. 어려운 개발</b>
<br />
마이크로 서비스가 네트워크 상에서 분산되어 있기 때문에 데이터나 네트워크를 등 여러 상황을 고려해야 함

마이크로 서비스는 독립적인 데이터 저장소를 갖기 때문에 데이터가 분산되어 있고, RDB의 트랜잭션을 사용할 수 없어 <span style="color:orange">데이터 정합성</span>이 맞지 않는 경우도 발생함

또한 네트워크를 통해 데이터를 통합해야 하는데, 네트워크는 신뢰할 수 없고 커넥션 비용도 비쌈

<b>2. 어려운 운영</b>
<br />
하나의 사용자 요청을 처리하기 위해 여러 마이크로 서비스가 통합되어 이용되는데, 요청 수행 중 에러가 발생했다면 어디서 에러가 발생했는지 찾기 쉽지 않음

<b>3. 어려운 설계</b>
<br />
각 마이크로 서비스가 관리하는 데이터들이 중복될 수 있고, 과도한 네트워크 통신이 발생하여 전체적인 시스템 성능이 저하될 수 있음

<br />
<br />
<br />

